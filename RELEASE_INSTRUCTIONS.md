# Инструкция по созданию релизного APK для приложения "Духовные песни"

Этот документ описывает шаги для создания подписанного релизного APK-файла, который можно публиковать в Google Play Store или распространять другими способами.

## Подготовка к релизу

### 1. Генерация ключа подписи (выполняется один раз)

Для подписи APK необходим файл keystore. Если у вас его еще нет, выполните следующие шаги:

1. Запустите скрипт `generate-keystore.bat` или выполните команду:
   ```
   keytool -genkey -v -keystore keystore/release-key.jks -alias maychurchkey -keyalg RSA -keysize 2048 -validity 10000
   ```

2. При выполнении команды вам будет предложено ввести:
   - Пароль для хранилища ключей (используется в local.properties: RELEASE_STORE_PASSWORD)
   - Имя и фамилию
   - Название организации
   - Название подразделения
   - Город
   - Регион/область
   - Код страны (RU для России)
   - Пароль для ключа (используется в local.properties: RELEASE_KEY_PASSWORD)

3. **ВАЖНО: Храните keystore файл в надежном месте!** Потеря файла ключа сделает невозможным обновление приложения в Google Play Store.

### 2. Настройка параметров подписи

Проверьте, что в файле `local.properties` правильно настроены параметры подписи:

```
RELEASE_STORE_FILE=keystore/release-key.jks
RELEASE_STORE_PASSWORD=ваш_пароль_хранилища
RELEASE_KEY_ALIAS=maychurchkey
RELEASE_KEY_PASSWORD=ваш_пароль_ключа
```

### 3. Проверка версии приложения

Перед сборкой релизного APK важно обновить версию приложения в `app/build.gradle.kts`:

```kotlin
versionCode = X    // Увеличивайте на 1 при каждом обновлении
versionName = "X.Y.Z"  // Семантическая версия приложения
```

Для публикации в Google Play:
- `versionCode` должен быть уникальным и увеличиваться с каждым обновлением
- `versionName` - визуальная версия, видимая пользователям

## Сборка релизного APK

### Метод 1: Использование скрипта

1. Запустите скрипт `build-release.bat`
2. Дождитесь завершения сборки
3. Релизный APK будет находиться в директории `app/build/outputs/apk/release/app-release.apk`
4. Android App Bundle (AAB) будет находиться в директории `app/build/outputs/bundle/release/app-release.aab`

### Метод 2: Использование Android Studio

1. В Android Studio выберите меню **Build → Generate Signed Bundle / APK**
2. Выберите **APK** или **Android App Bundle**
3. Укажите путь к хранилищу ключей, пароль, псевдоним ключа и пароль ключа
4. Выберите **release** для Build Variants
5. Нажмите **Finish** и дождитесь завершения сборки

## Тестирование релизной сборки

Перед публикацией обязательно протестируйте релизную сборку:

1. Установите APK на устройство: `adb install app/build/outputs/apk/release/app-release.apk`
2. Проверьте:
   - Все основные функции работают корректно
   - Производительность приложения на целевых устройствах
   - Отсутствие явных ошибок и сбоев

## Публикация в Google Play Store

Для публикации в Google Play Store:

1. Создайте аккаунт разработчика на [Google Play Console](https://play.google.com/console/)
2. Создайте новое приложение
3. Заполните все необходимые формы (описание, скриншоты, иконки и пр.)
4. Загрузите AAB-файл (`app-release.aab`) в разделе "Создание релиза"
5. Отправьте на проверку

## Важные замечания

- **ВСЕГДА делайте резервную копию файла keystore**. Потеря этого файла означает, что вы не сможете выпускать обновления для вашего приложения.
- Каждое обновление в Google Play должно иметь увеличенный `versionCode`.
- Рекомендуется использовать AAB вместо APK для публикации в Google Play, так как это позволяет уменьшить размер установки для пользователей.
- ProGuard включен в релизной сборке - проверьте, что все ваши классы и внешние библиотеки правильно настроены в `proguard-rules.pro`. 